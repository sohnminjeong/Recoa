<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BoardNotice">
	<resultMap type="BoardNotice" id="BoardNoticeMap">
		<id property="noticeCode" column="notice_code"/>
		<result property="userCode" column="user_code"/>	
		<result property="noticeTitle" column="notice_title"/>	
		<result property="noticeContent" column="notice_content"/>
		<result property="noticeWritedate" column="notice_writedate"/>
		<result property="noticeView" column="notice_view"/>
	</resultMap>
	
	<!-- 공지 작성 -->
	<insert id="registerNotice" parameterType="boardNotice" useGeneratedKeys="true" keyProperty="noticeCode" keyColumn="noticeCode">
		INSERT INTO board_notice(user_code, notice_title, notice_content, notice_writedate)
		VALUES(#{userCode}, #{noticeTitle}, #{noticeContent}, #{noticeWritedate})
	</insert>
	
	<!-- 공지 리스트 -->
	<select id="noticeList" parameterType="BoardNoticePaging" resultMap="BoardNoticeMap">
		SELECT *
		FROM board_notice
		<where>
			<choose>
				<when test="select=='all'">
					notice_title LIKE CONCAT('%', #{keyword}, '%')
					OR notice_content LIKE CONCAT('%', #{keyword}, '%')
				</when>
				<when test="select=='title'">
					notice_title LIKE CONCAT('%', #{keyword}, '%')
				</when>
				<when test="select=='content'">
					notice_content LIKE CONCAT('%', #{keyword}, '%')
				</when>
			</choose>
		</where>
		ORDER BY notice_code DESC
		LIMIT #{offset}, #{limit}
	</select>
	
	<!-- 공지 리스트 total -->
	<select id="noticeListTotal" parameterType="BoardNoticePaging" resultType="int">
		SELECT count(*) FROM board_notice
		<where>
			<choose>
				<when test="select == 'all'">
					notice_title LIKE CONCAT('%',#{keyword},'%') 
				OR notice_content LIKE CONCAT('%',#{keyword},'%')
				</when>
				<when test="select == 'title'">
					notice_title LIKE CONCAT('%',#{keyword},'%')
				</when>
				<when test="select == 'content'">
					notice_content LIKE CONCAT('%',#{keyword},'%')
				</when>
			</choose>
		</where>
	</select>
	
</mapper>